<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ipp="">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <title>QBO Connect</title>

  <script type="text/javascript" src="<%= appCenter %>/Content/IA/intuit.ipp.anywhere-1.3.1.js"></script>
  
  <script>
    intuit.ipp.anywhere.setup({
      grantUrl: 'http://localhost:' + <%= port %> + '/requestToken',
      datasources: {
        quickbooks : true,  // set to false if NOT using Quickbooks API
        payments : false    // set to true if using Payments API
      }
    });

    // Function to call the 'queryInvoice' endpoint
    function queryInvoice() {
      fetch('/queryInvoice', {
        method: 'GET',
      })
      .then(response => response.json())
      .then(data => {
        console.log("Invoice Data:", data);
        // Optionally, display the data on the page or process it
      })
      .catch(error => {
        console.error("Error during queryInvoice:", error);
      });
    }
  </script>
</head>
<body>
  <ipp:connectToIntuit></ipp:connectToIntuit><br>
  
  <!-- Add a button to trigger the queryInvoice function -->
  <button onclick="queryInvoice()">Fetch Invoices</button>

<script>
  async function queryInvoice() {
    try {
      const response = await fetch('/fetchInvoice');
      const data = await response.text();
      console.log(data);
    } catch (err) {
      console.error('Error fetching invoices:', err);
    }
  }
</script>

</body>
</html>
